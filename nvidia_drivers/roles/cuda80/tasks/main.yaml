---
- name: Try to find CUDA 8.0
  shell: "nvcc --version | grep '8.0'"
  register: nvcc_80
  environment:
    PATH: "{{ansible_env.PATH}}:{{cuda_bin}}"
    LD_LIBRARY_PATH: "{{cuda_lib}}"
  ignore_errors: true # do not stop playbook if CUDA not found

- debug:
    msg: "CUDA 8.0 found. Skipping installation of CUDA 8.0 Toolkit."
  when: nvcc_80|succeeded



- debug:
    msg: "CUDA 8.0 was not found when checking with command 'nvcc --version', using location {{cuda_install_dir}}. If you know you have CUDA 8.0 installed on your system, change the variable 'cuda_install_dir' in the playbook inventory. Otherwise, CUDA 8.0 Toolkit will now be installed."
  when: nvcc_80|failed

- name: Install CUDA
  include: cuda.yaml
  when: nvcc_80|failed 



